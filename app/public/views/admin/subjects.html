<div class="row">
	<div class="col-md-6">
		<h2 style="display: inline;">Subjects</h2>
		<button data-ng-click="showCreateDialog();" class="btn btn-lg btn-link glyphicon glyphicon-plus" style="padding: 0 0 10px 8px;"></button>
	</div>
	<div class="col-md-offset-2 col-md-4">
		<input type="text" placeholder="Filter" data-ng-model="searchText" autocomplete="off" autofocus="autofocus" class="form-control" />
	</div>
</div>

<table class="table table-striped" ng-init="predicate='name'; reverse=false;">
	<thead>
	<tr>
		<th class="col-md-2">
			Kurzname
			<button class="btn glyphicon glyphicon-chevron-up" data-ng-click="predicate='shortName'; reverse=false;" data-ng-class="{ 'btn-link': predicate != 'shortName' || !reverse }"></button>
			<button class="btn glyphicon glyphicon-chevron-down" data-ng-click="predicate='shortName'; reverse=true;" data-ng-class="{ 'btn-link': predicate != 'shortName' || reverse }"></button>
		</th>
		<th class="col-md-4">
			Name
			<span class="glyphicon glyphicon-chevron-up"></span>
			<span class="glyphicon glyphicon-chevron-down"></span>
		</th>
		<th class="col-md-2">
			Semester
			<span class="glyphicon glyphicon-chevron-up"></span>
			<span class="glyphicon glyphicon-chevron-down"></span>
		</th>
		<th class="col-md-2">
			Jahr
			<span class="glyphicon glyphicon-chevron-up"></span>
			<span class="glyphicon glyphicon-chevron-down"></span>
		</th>
		<th class="col-md-2">&nbsp;</th>
	</tr>
	</thead>
	<tbody>
	<tr data-ng-repeat="subject in subjects | filter:searchText">
		<td data-ng-bind="subject.module.shortName" />
		<td data-ng-bind="subject.module.name" />
		<td data-ng-bind="subject.semester" />
		<td data-ng-bind="subject.year" />
		<td class="text-right">
			<input data-ng-click="showEditDialog(subject)" type="button" value="Edit" class="btn btn-default" />
			<input data-ng-click="showDeleteDialog(subject)" type="button" value="Delete" class="btn btn-default" />
		</td>
	</tr>
	</tbody>
</table>

<div id="edit" tabindex="-1" role="dialog" aria-labelledby="edit-title" aria-hidden="true" class="modal fade">
	<form name="form" role="form" class="form-horizontal" data-ng-submit="save();">
		<div class="modal-dialog">
			<div class="modal-content">
				<header class="modal-header">
					<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
					<h4 data-ng-bind="!subject._id ? 'Create new subject' : 'Edit subject'" id="edit-title" class="modal-title"></h4>
				</header>
				<div class="modal-body">

					<div class="form-group" data-ng-class="{ 'has-error': form.module.$invalid }">
						<label for="module" class="col-sm-4 control-label">Module:</label>
						<div class="col-sm-8">
							<select id="module" name="module"
									data-ng-model="subject.module"
									data-ng-options="module.name for module in modules"
									required="required"
									class="form-control"></select>
						</div>
					</div>

					<div class="form-group" data-ng-class="{ 'has-error': form.semester.$invalid }">
						<label for="semester" class="col-sm-4 control-label">Semester:</label>
						<div class="col-sm-8">
							<select id="semester" name="semester"
									data-ng-model="subject.semester"
									data-ng-options="s.key as s.name for s in semester"
									required="required"
									class="form-control"></select>
						</div>
					</div>

					<div class="form-group" data-ng-class="{ 'has-error': form.year.$invalid }">
						<label for="year" class="col-sm-4 control-label">Year</label>
						<div class="col-sm-8">
							<input id="year" name="year" type="year"
								   data-ng-model="subject.year"
								   data-ng-pattern="/^([0-9]{4})$/"
								   required="required"
								   class="form-control"/>
						</div>
					</div>

				</div>
				<div class="modal-footer">
					<button data-ng-click="hideDialog();" type="button" class="btn btn-default pull-left">Cancel</button>
					<button data-ng-disabled="form.$invalid" type="submit" class="btn btn-primary pull-right">Save</button>
				</div>
			</div>
		</div>
	</form>
</div>

<div class="modal fade" id="delete" tabindex="-1" role="dialog" aria-labelledby="delete-title" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<header class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
				<h4 id="delete-title" class="delete-title">Delete subject?</h4>
			</header>
			<div class="modal-body">
				<p>
					(<span data-ng-bind="subject.module.shortName"></span>)
					<span data-ng-bind="subject.module.name"></span>
					<span data-ng-bind="subject.semester"></span>
					<span data-ng-bind="subject.year"></span>
				</p>
			</div>
			<div class="modal-footer">
				<button data-ng-click="hideDialog();" type="button" class="btn btn-default pull-left">Cancel</button>
				<button data-ng-click="delete();" type="button" class="btn btn-danger pull-right">Delete</button>
			</div>
		</div>
	</div>
</div>
